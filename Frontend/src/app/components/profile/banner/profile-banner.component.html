<section class="profile-banner">
  <div class="banner-cover">
    <img
      src="https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=1200&q=80"
      alt="Cover"
      class="cover-img"
    />
  </div>

  <div class="banner-body">
    <div class="banner-info-row">
      <div class="avatar-wrapper">
        <img
          [src]="user?.profile_image || 'assets/icons/profile.svg'"
          [alt]="user?.name || 'Profile'"
          class="avatar-img"
        />
        <!-- Upload overlay only for owner -->
        <button
          *ngIf="isOwner"
          class="upload-overlay"
          (click)="openFileSelector()"
          [disabled]="uploading"
          type="button"
        >
          <svg *ngIf="!uploading" width="24" height="24" viewBox="0 0 24 24" fill="white">
            <path
              d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"
            />
            <circle cx="12" cy="13" r="4" />
          </svg>
          <svg
            *ngIf="uploading"
            class="spinner"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="white"
            stroke-width="2"
          >
            <circle cx="12" cy="12" r="10" />
          </svg>
        </button>
        <!-- Hidden file input -->
        <input
          #fileInput
          type="file"
          accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
          (change)="onFileSelected($event)"
          style="display: none"
        />
      </div>

      <div class="banner-main-info">
        <div class="name-row">
          <h1 class="name">{{ user?.name || 'No Name' }}</h1>
        </div>
        <p class="headline">{{ user?.title || '' }}</p>
        <div class="location-row" *ngIf="user?.location">
          <svg class="location-icon" width="16" height="16" viewBox="0 0 24 24" fill="#2563eb">
            <path
              d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"
            />
          </svg>
          <span class="location-text">{{ user?.location }}</span>
        </div>
      </div>

      <!-- Only show share/like for other people's profiles -->
      <div class="banner-actions" *ngIf="!isOwner">
        <button class="btn-icon" aria-label="Share">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#64748b"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8" />
            <polyline points="16 6 12 2 8 6" />
            <line x1="12" y1="2" x2="12" y2="15" />
          </svg>
        </button>
        <button class="btn-icon" aria-label="Save">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#64748b"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path
              d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"
            />
          </svg>
        </button>
      </div>
    </div>

    <div class="stats-row">
      <div class="stat">
        <div class="stat-value">{{ user?.rating || 0 }} <span class="stat-star">â˜…</span></div>
        <div class="stat-label">RATING</div>
      </div>
      <div class="stat-divider"></div>
      <div class="stat">
        <div class="stat-value">{{ user?.review_count || 0 }}</div>
        <div class="stat-label">JOBS DONE</div>
      </div>
    </div>

    <!-- Error message -->
    <div *ngIf="errorMessage" class="error-banner">
      {{ errorMessage }}
    </div>
  </div>
</section>
